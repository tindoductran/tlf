 DMC = [["1","White Tin","#efeef0"],
["2","Tin","#c5c4c9"],
["3","Medium Tin","#b0b0b5"],
["4","Dark Tin","#9c9b9d"],
["5","Light Driftwood","#e3ccbe"],
["6","Medium Light Driftwood","#dcc6b8"],
["7","Driftwood","#ccb8aa"],
["8","Dark Driftwood","#9d7d71"],
["9","Very Dark Cocoa","#552014"],
["10","Very Light Tender Green","#edfed9"],
["11","Light Tender Green","#e2edb5"],
["12","Tender Green","#cdd99a"],
["13","Medium Light Nile Green","#bff6e0"],
["14","Pale Apple Green","#d0fbb2"],
["15","Apple Green","#d1eda4"],
["16","Light Chartreuse","#a4d67c"],
["17","Light Yellow Plum","#e5e272"],
["18","Yellow Plum","#d9d56d"],
["19","Medium Light Autumn Gold","#f7c95f"],
["20","Shrimp","#f7af93"],
["21","Light Alizarian","#d79982"],
["22","Alizarian","#bc604e"],
["23","Apple Blossom","#ede2ed"],
["24","White Lavender","#e0d7ee"],
["25","Ultra Light Lavender","#dad2e9"],
["26","Pale Lavender","#cfc8de"],
["27","White Violet","#e9ecfc"],
["28","Medium Light Eggplant","#7d4e92"],
["29","Eggplant","#674076"],
["30","Medium Light Blueberry","#6d54d3"],
["31","Blueberry","#5834a3"],
["32","Dark Blueberry","#4d2e8a"],
["33","Fuchsia","#d9539f"],
["34","Dark Fuchsia","#ae4280"],
["35","Very Dark Fuchsia","#732b55"],["Ecru","Ecru/off-white","#fff7e7"],["315","Antique Mauve - MED DK","#7d4246"], ["Blanc","White","#eeeeee"],["316","Antique Mauve - MED","#bc757f"], ["B5200","Snow White","#fcfcff"],["317","Pewter Gray","#6d6469"], ["White","White","#ffffff"],["318","Steel Gray - LT","#999b9d"], ["150","Red - BRIGHT","#cf0053"],["319","Pistachio Green - VY DK","#3a553b"], ["151","Pink","#ffcbd7"],["320","Pistachio Green - MED","#608c59"], ["152","Tawny - DK","#e1a1a1"],["321","Red","#bd1136"], ["153","Lilac","#eac5eb"],["322","Baby Blue","#3a609d"], ["154","Red - VY DK","#4b233a"],["326","Rose - VY DK","#ac1c37"], ["155","Forget-me-not Blue","#9774b6"],["327","Violet","#5e0f77"], ["156","Blue - MED","#8577b4"],["333","Blue Violet - VY DK","#6e2e9b"], ["157","Blue - LT","#b5b8ea"],["334","Baby Blue - MED","#6085b8"], ["158","Blue - DK","#393068"],["335","Rose","#d63d57"], ["159","Petrol Blue - LT","#bcb5de"],["336","Blue","#0c275e"], ["160","Petrol Blue - MED","#8178a9"],["340","Blue Violet - MED","#996dc3"], ["161","Petrol Blue - DK","#60568b"],["341","Blue Violet - LT","#a39ad7"], ["162","Baby Blue - LT","#cae7f0"],["347","Salmon - VY DK","#ab1b33"], ["163","Green","#557a60"],["349","Coral - DK","#c62c38"], ["164","Green - LT","#bae4b6"],["350","Coral - MED","#de3f40"], ["165","Green - BRIGHT","#e1f477"],["351","Coral","#ed625b"], ["166","Lime Green","#adc238"],["352","Coral - LT","#f78372"], ["167","Khaki Brown","#855d31"],["353","Peach","#fdb4a1"], ["168","Silver Gray","#b1aeb7"],["355","Terra Cotta - DK","#97382b"], ["169","Pewter Gray","#827d7d"],["356","Terra Cotta - MED","#be5c4b"], ["208","Lavender - VY DK","#9442a7"],["367","Pistachio Green - DK","#446b45"], ["209","Lavender - DK","#ba72c6"],["368","Pistachio Green - LT","#7fc66d"], ["210","Lavender - MED","#d49fe1"],["369","Pistachio Green - VY LT","#cdefa6"], ["211","Lavender - LT","#e5bded"],["370","Mustard - MED","#917245"], ["221","Shell Pink - VY DK","#792631"],["371","Mustard","#9f8352"], ["223","Shell Pink - LT","#bb6864"],["372","Mustard - LT","#ad9564"], ["224","Shell Pink - VY LT","#e2a598"],["400","Mahogany - DK","#813718"], ["225","Shell Pink - ULT VY LT","#f8d9cd"],["402","Mahogany - VY LT","#ef9e74"], ["300","Mahogany - VY DK","#6c3116"],["407","Desert Sand - DK","#b77159"], ["301","Mahogany - MED","#aa5237"],["413","Pewter Gray - DK","#4a4749"], ["304","Red - MED","#a10c39"],["414","Steel Gray - DK","#766e72"], ["307","Lemon","#fde949"],["415","Pearl Gray","#b8b9bd"], ["309","Rose - DK","#ba2044"],["420","Hazelnut Brown - DK","#855a30"], ["310","Black","#000000"],["422","Hazelnut Brown - LT","#c99a67"], ["311","Blue - MED","#002a64"],["433","Brown - MED","#73421e"], ["312","Baby Blue - VY DK","#1f3279"],["434","Brown - LT","#8f5332"],["435","Brown - VY LT","#a96538"],["600","Cranberry - VY DK","#bf1c48"], ["436","Tan","#c78559"],["601","Cranberry - DK","#c62a53"], ["437","Tan - LT","#daa26f"],["602","Cranberry - MED","#d63f68"], ["444","Lemon - DK","#f5bc13"],["603","Cranberry","#ed5d84"], ["445","Lemon - LT","#fcf999"],["604","Cranberry - LT","#f793b2"], ["451","Shell Gray - DK","#887773"],["605","Cranberry - VY LT","#fbacc4"], ["452","Shell Gray - MED","#ad9994"],["606","Orange-red - BRIGHT","#f70f00"], ["453","Shell Gray - LT","#ccb8aa"],["608","Orange - BRIGHT","#fd480c"], ["469","Avocado Green","#5b6533"],["610","Drab Brown - DK","#6b5039"], ["470","Avocado Green - LT","#72813e"],["611","Drab Brown","#7c5f46"], ["471","Avocado Green - VY LT","#9eb357"],["612","Drab Brown - LT","#a6885e"], ["472","Avocado Green - ULT LT","#d1de75"],["613","Drab Brown - VY LT","#b99f72"], ["498","Red - DK","#970b2c"],["632","Desert Sand - ULT VY DK","#7f4232"], ["500","Blue Green - VY DK","#1d362a"],["640","Beige Gray - VY DK","#817868"], ["501","Blue Green - DK","#2f5446"],["642","Beige Gray - DK","#958d79"], ["502","Blue Green","#57826e"],["644","Beige Gray - MED","#c4bea6"], ["503","Blue Green - MED","#89b89f"],["645","Beaver Gray - VY DK","#5d5d54"], ["504","Blue Green - VY LT","#acdac1"],["646","Beaver Gray - DK","#6b6860"], ["505","Grass Green - DK","#ceddc1"],["647","Beaver Gray - MED","#908e85"], ["517","Wedgewood - DK","#216285"],["648","Beaver Gray - LT","#a7a69f"], ["518","Wedgewood - LT","#50819c"],["666","Red - BRIGHT","#ce1b33"], ["519","Sky Blue","#94b7cb"],["676","Old Gold - LT","#ecbf7d"], ["520","Fern Green - DK","#384526"],["677","Old Gold - VY LT","#f2dc9f"], ["522","Fern Green","#808b6e"],["680","Old Gold - DK","#b07b46"], ["523","Fern Green - LT","#959f7a"],["699","Green","#075b26"], ["524","Fern Green - VY LT","#aea78e"],["700","Green - BRIGHT","#076c34"], ["535","Ash Gray - VY LT","#4b4b49"],["701","Green - LT","#217c36"], ["543","Beige Brown - ULT VY LT","#ead0b5"],["702","Kelly Green","#379130"], ["550","Violet - VY DK","#580e5c"],["703","Chartreuse","#63b330"], ["552","Violet - MED","#902f99"],["704","Chartreuse - BRIGHT","#88c53a"], ["553","Violet","#a449ac"],["712","Cream","#f6efda"], ["554","Violet - LT","#dc9cde"],["718","Plum","#cb2089"], ["561","Jade - VY DK","#285e48"],["720","Orange Spice - DK","#c83a24"], ["562","Jade - MED","#3b8c5a"],["721","Orange Spice - MED","#f46440"], ["563","Jade - LT","#6ed39a"],["722","Orange Spice - LT","#f98756"], ["564","Jade - VY LT","#95e4af"],["725","Topaz","#f9c15b"], ["580","Moss Green - DK","#355f0b"],["726","Topaz - LT","#fddb63"], ["581","Moss Green","#838a29"],["727","Topaz - VY LT","#fde98b"], ["597","Turquoise","#52adab"],["728","Golden Yellow","#f2ae3f"], ["598","Turquoise - LT","#97d8d3"],["729","Old Gold - MED","#ce9657"],["730","Olive Green - VY DK","#63520b"],["803","Blue - DEEP","#202754"],["731","Olive Green - DK","#6b580b"],["806","Peacock Blue - DK","#1d6c87"],["732","Olive Green","#725c0c"],["807","Peacock Blue","#558b9e"],["733","Olive Green - MED","#a78a44"],["809","Delft Blue","#919fd5"],["734","Olive Green - LT","#bb9c54"],["813","Blue - LT","#7fa0c6"],["738","Tan - VY LT","#e2b783"],["814","Garnet - DK","#711033"],["739","Tan - ULT VY LT","#f2deb9"],["815","Garnet - MED","#800b34"],["740","Tangerine","#fd6f1a"],["816","Garnet","#921238"],["741","Tangerine - MED","#fc8b10"],["817","Coral Red - VY DK","#bb1630"],["742","Tangerine - LT","#fdae3c"],["818","Baby Pink","#fededd"],["743","Yellow - MED","#fdd769"],["819","Baby Pink - LT","#fcebde"],["744","Yellow - PALE","#fee88d"],["820","Royal Blue - VY DK","#151264"],["745","Yellow - LT PALE","#feeba5"],["822","Beige Gray - LT","#e8dfc7"],["746","Off White","#faf2d5"],["823","Blue - DK","#000b44"],["747","Sky Blue - VY LT","#cee9ea"],["824","Blue - VY DK","#284779"],["754","Peach - LT","#f7c9b0"],["825","Blue - DK","#34588f"],["758","Terra Cotta - VY LT","#e99f83"],["826","Blue - MED","#5075a7"],["760","Salmon","#ec8880"],["827","Blue - VY LT","#a4c1de"],["761","Salmon - LT","#f8b4ad"],["828","Blue - ULT VY LT","#c3d7e6"],["762","Pearl Gray - VY LT","#d1d0d2"],["829","Golden Olive - VY DK","#64480c"],["772","Yellow Green - VY LT","#d7efa7"],["830","Golden Olive - DK","#6e501d"],["775","Baby Blue - VY LT","#d4e3ef"],["831","Golden Olive - MED","#7c5f20"],["776","Pink - MED","#fca8ad"],["832","Golden Olive","#9c7230"],["777","Red - DEEP","#9b0042"],["833","Golden Olive - LT","#b99956"],["778","Antique Mauve - VY LT","#dca6a4"],["834","Golden Olive - VY LT","#d2b468"],["779","Brown","#53332d"],["838","Beige Brown - VY DK","#4a3021"],["780","Topaz - ULT VY DK","#945026"],["839","Beige Brown - DK","#5a3c2d"],["781","Topaz - VY DK","#a25f1f"],["840","Beige Brown - MED","#7a5939"],["782","Topaz - DK","#b26923"],["841","Beige Brown - LT","#a37d64"],["783","Topaz - MED","#d0883d"],["842","Beige Brown - VY LT","#cbb094"],["791","Cornflower Blue - VY DK","#2d2068"],["844","Beaver Gray - ULT DK","#494842"],["792","Cornflower Blue - DK","#454b8b"],["868","Hazel Nut Brown","#995c30"],["793","Cornflower Blue - MED","#7c82b5"],["869","Hazelnut Brown - VY DK","#784c28"],["794","Cornflower Blue - LT","#a0b2d7"],["890","Pistachio Green - ULT DK","#324233"],["796","Royal Blue - DK","#272276"],["891","Carnation - DK","#ee3246"],["797","Royal Blue","#2b3288"],["892","Carnation - MED","#f44753"],["798","Delft Blue - DK","#4e5ca7"],["893","Carnation - LT","#f66879"],["799","Delft Blue - MED","#6b7fc0"],["894","Carnation - VY LT","#fd95a3"],["800","Delft Blue - PALE","#b5c7e9"],["895","Hunter Green - VY DK","#344b2e"],["801","Coffee Brown - DK","#60391d"],["898","Coffee Brown - VY DK","#532f1b"],["899","Rose - MED","#ea6b78"],["955","Nile Green - LT","#a8ebad"],["900","Burnt Orange - DK","#c63117"],["956","Geranium","#f7566d"],["902","Garnet - VY DK","#651329"],["957","Geranium - PALE","#fd99af"],["904","Parrot Green - VY DK","#386324"],["958","Seagreen - DK","#0db294"],["905","Parrot Green - DK","#467924"],["959","Seagreen - MED","#72d0b7"],["906","Parrot Green - MED","#6c9e29"],["961","Dusty Rose - DK","#de586c"],["907","Parrot Green - LT","#9dc72d"],["962","Dusty Rose - MED","#eb7183"],["909","Emerald Green - VY DK","#106b43"],["963","Dusty Rose - ULT VY LT","#fdccd1"],["910","Emerald Green - DK","#10814e"],["964","Seagreen - LT","#a5e4d4"],["911","Emerald Green - MED","#109256"],["966","Baby Green - MED","#94d28a"],["912","Emerald Green - LT","#36b26b"],["967","Peach - LT","#ffc2ac"],["913","Nile Green - MED","#55ca7d"],["970","Pumpkin - LT","#fb6721"],["915","Plum - DK","#95085a"],["971","Pumpkin","#fc670d"],["917","Plum - MED","#ac1071"],["972","Canary - DEEP","#fb9f11"],["918","Red Copper - DK","#883630"],["973","Canary - BRIGHT","#fccd2d"],["919","Red Copper","#9b371b"],["975","Golden Brown - DK","#813c11"],["920","Copper - MED","#ab4836"],["976","Golden Brown - MED","#cf7532"],["921","Copper","#c0573d"],["977","Golden Brown - LT","#ec8f43"],["922","Copper - LT","#dd6e4c"],["986","Forest Green - VY DK","#2e5230"],["924","Gray Green - VY DK","#384a4a"],["987","Forest Green - DK","#436838"],["926","Gray Green - MED","#617674"],["988","Forest Green - MED","#66924a"],["927","Gray Green - LT","#9fa8a5"],["989","Forest Green","#71a74e"],["928","Gray Green - VY LT","#c0c6c0"],["991","Aquamarine - DK","#135f55"],["930","Antique Blue - DK","#495c6b"],["992","Aquamarine - LT","#42b59e"],["931","Antique Blue - MED","#667684"],["993","Aquamarine - VY LT","#62d8b6"],["932","Antique Blue - LT","#93a0af"],["995","Electric Blue - DK","#0061b0"],["934","Avocado Green - BLACK","#323324"],["996","Electric Blue - MED","#49a8eb"],["935","Avocado Green - DK","#383a2a"],["3011","Khaki Green - DK","#655935"],["936","Avocado Green - VY DK","#3f4227"],["3012","Khaki Green - MED","#8b7b4e"],["937","Avocado Green - MED","#434f2c"],["3013","Khaki Green - LT","#afa97b"],["938","Coffee Brown - ULT DK","#45271a"],["3021","Brown Gray - VY DK","#50403b"],["939","Blue - VY DK","#09092f"],["3022","Brown Gray - MED","#848274"],["943","Aquamarine - MED","#009a77"],["3023","Brown Gray - LT","#a29b86"],["945","Tawny","#f6c19a"],["3024","Brown Gray - VY LT","#beb8ac"],["946","Burnt Orange - MED","#ed4115"],["3031","Mocha Brown - VY DK","#423014"],["947","Burnt Orange","#fc4f16"],["3032","Mocha Brown - MED","#9d8868"],["948","Peach - VY LT","#fde6d3"],["3033","Mocha Brown - VY LT","#dbc7ad"],["950","Desert Sand - LT","#e5ac8d"],["3041","Antique Violet - MED","#866a76"],["951","Tawny - LT","#faddb6"],["3042","Antique Violet - LT","#af98a0"],["954","Nile Green","#6fda8a"],["3045","Yellow Beige - DK","#af8152"],["3046","Yellow Beige - MED","#ceb074"],["3731","Dusty Rose - VY DK","#c34c5c"],["3047","Yellow Beige - LT","#ead8ab"],["3733","Dusty Rose","#ea7e86"],["3051","Green Gray - DK","#4c4c1e"],["3740","Antique Violet - DK","#71535d"],["3052","Green Gray - MED","#787e5c"],["3743","Antique Violet - VY LT","#cfc2c9"],["3053","Green Gray","#999d75"],["3746","Blue Violet - DK","#844ab5"],["3064","Desert Sand","#ba7056"],["3747","Blue Violet - VY LT","#d0c5ec"],["3072","Beaver Gray - VY LT","#d2d2ca"],["3750","Antique Blue - VY DK","#1d4552"],["3078","Golden Yellow - VY LT","#fcf6b6"],["3752","Antique Blue - VY LT","#bac9cc"],["3325","Baby Blue - LT","#adcde7"],["3753","Antique Blue - ULT VY LT","#d9e6ec"],["3326","Rose - LT","#f9979c"],["3755","Baby Blue (?)","#81a5d8"],["3328","Salmon - DK","#be444a"],["3756","Baby Blue","#e9f4fa"],["3340","Apricot - MED","#fd6b4f"],["3760","Wedgewood - MED","#467293"],["3341","Apricot","#fd8e78"],["3761","Sky Blue - LT","#b1d0df"],["3345","Hunter Green - DK","#40552e"],["3765","Peacock Blue - VY DK","#175e78"],["3346","Hunter Green","#56743b"],["3766","Peacock Blue - LT","#4b8aa1"],["3347","Yellow Green - MED","#6d9646"],["3768","Gray Green - DK","#4c605f"],["3348","Yellow Green - LT","#bedf74"],["3770","Tawny - VY LT","#fef1d8"],["3350","Dusty Rose - ULT DK","#aa3949"],["3771","Peach - DK","#e8ac9b"],["3354","Dusty Rose - LT","#efa5ac"],["3772","Desert Sand - VY DK","#995744"],["3362","Pine Green - DK","#49523c"],["3773","Desert Sand - MED","#cf866d"],["3363","Pine Green - MED","#617451"],["3774","Desert Sand - VY LT","#f3cfb4"],["3364","Pine Green","#8e9b6d"],["3776","Mahogany - LT","#c96444"],["3371","Black Brown","#36220e"],["3777","Terra Cotta - VY DK","#922f25"],["3607","Plum - LT","#d94c9d"],["3778","Terra Cotta - LT","#d2705c"],["3608","Plum - VY LT","#ec81be"],["3779","Terra Cotta - ULT VY LT","#f2ab95"],["3609","Plum - ULT LT","#f6b0df"],["3781","Mocha Brown - DK","#593f2b"],["3685","Mauve - VY DK","#79263b"],["3782","Mocha Brown - LT","#b69d80"],["3687","Mauve","#b5455d"],["3787","Brown Gray - DK","#62524c"],["3688","Mauve - MED","#dc7c86"],["3790","Beige Gray - ULT DK","#6d5a4b"],["3689","Mauve - LT","#f8bbc8"],["3799","Pewter Gray - VY DK","#39393d"],["3705","Melon - DK","#f2494f"],["3801","Melon - VY DK","#e4353d"],["3706","Melon - MED","#fd6e70"],["3802","Antique Mauve - VY DK","#672a33"],["3708","Melon - LT","#fda0ae"],["3803","Mauve - DK","#872a43"],["3712","Salmon - MED","#d95d5d"],["3804","Cyclamen Pink - DK","#ce2b63"],["3713","Salmon - VY LT","#fdd5d0"],["3805","Cyclamen Pink","#df3c73"],["3716","Dusty Rose - VY LT","#fcafb9"],["3806","Cyclamen Pink - LT","#f15a91"],["3721","Shell Pink - DK","#933b3d"],["3807","Cornflower Blue","#4b599e"],["3722","Shell Pink - MED","#a04b4c"],["3808","Turquoise - ULT VY DK","#03535c"],["3726","Antique Mauve - DK","#95565c"],["3809","Turquoise - VY DK","#136a75"],["3727","Antique Mauve - LT","#da9ea6"],["3810","Turquoise - DK","#2d8d98"],["3811","Turquoise - VY LT","#a8e2e5"],["3839","Lavender Blue - MED","#7a7ec5"],["3812","Seagreen - VY DK","#07a184"],["3840","Lavender Blue - LT","#b2bdea"],["3813","Blue Green - LT","#86c3ab"],["3841","Baby Blue - PALE","#d9eaf2"],["3814","Aquamarine","#0b8673"],["3842","Wedgewood - DK","#06506a"],["3815","Celadon Green - DK","#437259"],["3843","Electric Blue","#28a3de"],["3816","Celadon Green","#60937a"],["3844","Bright Turquoise - DK","#1f7fa0"],["3817","Celadon Green - LT","#81c6a4"],["3845","Bright Turquoise - MED","#2badd1"],["3818","Emerald Green - ULT VY DK","#005d2e"],["3846","Bright Turquoise - LT","#5eccec"],["3819","Moss Green - LT","#ccc959"],["3847","Teal Green - DK","#186358"],["3820","Straw - DK","#dba53e"],["3848","Teal Green - MED","#207e72"],["3821","Straw","#ebbb52"],["3849","Teal Green - LT","#35b193"],["3822","Straw - LT","#f7d169"],["3850","Bright Green - DK","#208b46"],["3823","Yellow - ULT PALE","#fef5cd"],["3851","Bright Green - LT","#61bb84"],["3824","Apricot - LT","#fcae99"],["3852","Straw - VY DK","#e3a730"],["3825","Pumpkin - PALE","#fea370"],["3853","Autumn Gold - DK","#ef8125"],["3826","Golden Brown","#b16633"],["3854","Autumn Gold - MED","#fbac56"],["3827","Golden Brown - PALE","#eaa664"],["3855","Autumn Gold - LT","#fddfa0"],["3828","Hazelnut Brown","#aa7c43"],["3856","Mahogany - ULT VY LT","#fdbe8e"],["3829","Old Gold - VY DK","#a7671d"],["3857","Rosewood - DK","#6a2f26"],["3830","Terra Cotta","#a94138"],["3858","Rosewood - MED","#803a32"],["3831","Raspberry - DK","#c12b52"],["3859","Rosewood - LT","#ba7a6c"],["3832","Raspberry - MED","#e36370"],["3860","Cocoa","#896362"],["3833","Raspberry - LT","#ea8b96"],["3861","Cocoa - LT","#ac8583"],["3834","Grape - DK","#6a2258"],["3862","Mocha Beige - DK","#6e492a"],["3835","Grape - MED","#924d78"],["3863","Mocha Beige - MED","#94725d"],["3836","Grape - LT","#c597b9"],["3864","Mocha Beige - LT","#c9aa92"],["3837","Lavender - ULT DK","#8a2a8f"],["3865","Winter White","#fffdf9"],["3838","Lavender Blue - DK","#606bad"],["3866","Mocha Brown - ULT VY LT","#f0e6d7"],["3880","Medium Very Dark Shell Pink","#793c37"],["3881","Pale Avocado Green","#8fa463"],["3882","Medium Light Cocoa","#674732"],["3883","Medium Light Copper","#dd6f32"],["3884","Medium Light Pewter","#676e6b"],["3885","Medium Very Dark Blue","#054281"],["3886","Very Dark Plum","#6c0d53"],["3887","Ultra Very Dark Lavender","#633888"],["3888","Medium Dark Antique Violet","#6b5b66"],["3889","Medium Light Lemon","#f1dc4c"],["3890","Very Light Bright Turquoise","#38cbee"],["3891","Very Dark Bright Turquoise","#055f9d"],["3892","Medium Light Orange Spice","#f66209"],["3893","Very Light Mocha Beige","#cbad97"],["3894","Very Light Parrot Green","#90ac09"],["3895","Medium Dark Beaver Gray","#878471"]];
 items = DMC.length;
 
 DMCstandard = 0;
 method = 6;
 blend = 0;
 blendtype = 2; //2 for 50/50, 3 for thirdblend

 R = 0;
 G = 0;
 B = 0;
 function copyLink() {
  /* Get the text field */
  var copyText = document.getElementById("hiddenlink");

  /* Select the text field */
  copyText.select();
  copyText.setSelectionRange(0, 99999); /*For mobile devices*/

  /* Copy the text inside the text field */
  document.execCommand("copy");

  /* Alert the copied text */
  alert("Link copied:" + copyText.value);
} 
for (var i = 0; i < items; i++) {
    DMC[i][3] = hex_to_rgb(DMC[i][2]); //index 3 stores RGB values of hex value of index 2
  DMC[i][4] = 0; //index 4 stores place holder for dif calculation
}
DMCstandard = jQuery.extend(true, {}, DMC);
var c = document.getElementById("myCanvas");
ctx = c.getContext("2d");
function changeRGB(){
	R = document.getElementById("R").value;
	G = document.getElementById("G").value;
	B = document.getElementById("B").value;
	link = "https://cs-pattern.com/dcp.php?R=" + R + "&G=" + G + "&B=" +B;
	document.getElementById('hiddenlink').value=link;
	document.getElementById('linktothis').innerHTML = "<b>Reference Link to this Chosen color:</b>";
	find_closest_color_default();
	updateAlternate();
}
function updateAlternate(){
  R = document.getElementById("R").value;
  G = document.getElementById("G").value;
  B = document.getElementById("B").value;
  link = "https://cs-pattern.com/acp.php?R=" + R + "&G=" + G + "&B=" +B;
  link2 = "https://cs-pattern.com/ccp.php?R=" + R + "&G=" + G + "&B=" +B;
  link3 = "https://cs-pattern.com/scp.php?R=" + R + "&G=" + G + "&B=" +B;
  alllinks = "<a href='"+link+"'>Find Anchor Thread for this color</a><br/>" + 
             "<a href='"+link2+"'>Find Cosmo Thread for this color</a><br/>" + 
             "<a href='"+link3+"'>Find Sullivans Thread for this color</a>";
  document.getElementById('alternate').innerHTML = alllinks;
}
function find_closest_color_default(){
	if (method == 1){
        find_closest_color_perceptive();
    }else if (method ==2){
        find_closest_color();
    }else if (method ==3) {
        find_closest_lab();
  }else if (method == 4){
    find_closest_color_naive();
  }else if (method == 5){
    find_closest_hue();
  }else if (method == 6){
    find_closest_deltaE();
  }
}
function hexToRgb(hex) {
    var result = /^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(hex);
    return result ? {
        r: parseInt(result[1], 16),
        g: parseInt(result[2], 16),
        b: parseInt(result[3], 16)
    } : null;
}
function componentToHex(c) {
    var hex = c.toString(16);
    return hex.length == 1 ? "0" + hex : hex;
}

function rgb_to_hex(rgb) {
    return "#" + componentToHex(rgb[0]) + componentToHex(rgb[1]) + componentToHex(rgb[2]);
}
function hex_to_rgb(hex){
  rgb = hexToRgb(hex);
  return [rgb.r,rgb.g,rgb.b];
}


//ctx.fillRect(20, 20, 150, 100);
function outText(text,x,y){
  ctx.font = "15px Arial";
  ctx.fillStyle = "black";
  ctx.fillText(text,x,y);
}
function outTextSmall(text,x,y){
  ctx.font = "11px Arial";
  ctx.fillStyle = "black";
  ctx.fillText(text,x,y);
}

function draw_title(){
  //ctx.font = "15px Arial";
  ctx.fillStyle = "black";
  outText("Your chosen color:",10,20);
  outText("Matching:",200,20);
    outText("#",310,20);
    outText("DMC",340,20);
    outText("Name",430,20);
}
function readinputs(){
  R = parseInt(document.getElementById("R").value);
  G = parseInt(document.getElementById("G").value);
  B = parseInt(document.getElementById("B").value);
}



function rectangle(x,y,color){
    height = 15;
    width = 100;
  ctx.fillStyle = rgb_to_hex(color);
  ctx.fillRect(x, y, width, height);
}
function rectangle_blend_dots(x,y,bdmc,blend){
    height = 15
    width = 100
    for (var i=0;i<height+1;i++){ //i in range(0,height+1):
        for (var j=0;j<width+1;j++){//in range(0,width+1):
        	if (blendtype < 4){
        		skipsquare = blendtype;
			}else if (blendtype == 4){ //1+3 strands
				if (bdmc[5]==1){
					skipsquare = 4;
				}else if (bdmc[5]==2){ //2+2 strands
					skipsquare = 2;
				}
			}else if (blendtype == 5){
				skipsquare = 5;
			}else if (blendtype == 6){
				skipsquare = 6;
			}
            if ((Math.ceil(i/blend)+Math.ceil(j/blend)) % skipsquare == 0){
                color = DMC[bdmc[1]][3];
            }else{
                color = DMC[bdmc[2]][3];
            }
            if (blendtype == 5){
            	if (bdmc[5]==1){
            		if ((Math.ceil(i/blend)+Math.ceil(j/blend)) % 5 == 0){
             		   color = DMC[bdmc[1]][3];
            		}else{
                		color = DMC[bdmc[2]][3];
            		}	
            	}else if (bdmc[5]==2){
            		if (((Math.ceil(i/blend)+Math.ceil(j/blend)) % skipsquare == 0) || ((Math.ceil(i/blend)+Math.ceil(j/blend)) % skipsquare == 2)){
             		   color = DMC[bdmc[1]][3];
            		}else{
                		color = DMC[bdmc[2]][3];
            		}	
            	}
            }
            if (blendtype == 6){
            	if (bdmc[5]==1){
            		if ((Math.ceil(i/blend)+Math.ceil(j/blend)) % skipsquare == 0){
             		   color = DMC[bdmc[1]][3];
            		}else{
                		color = DMC[bdmc[2]][3];
            		}	
            	}else if (bdmc[5]==2){
            		if (((Math.ceil(i/blend)+Math.ceil(j/blend)) % skipsquare == 0) || ((Math.ceil(i/blend)+Math.ceil(j/blend)) % skipsquare == 3)){
             		   color = DMC[bdmc[1]][3];
            		}else{
                		color = DMC[bdmc[2]][3];
            		}	
            	}else if (bdmc[5]==3){
            		if (((Math.ceil(i/blend)+Math.ceil(j/blend)) % skipsquare == 0) || ((Math.ceil(i/blend)+Math.ceil(j/blend)) % skipsquare == 2)|| ((Math.ceil(i/blend)+Math.ceil(j/blend)) % skipsquare == 4)){
             		   color = DMC[bdmc[1]][3];
            		}else{
                		color = DMC[bdmc[2]][3];
            		}	
            	}
            }
      ctx.fillStyle = rgb_to_hex(color);
      ctx.fillRect( x+j, y+i, 1, 1 );
    }
  }
            //canvas.draw_point((x+j,y+i), rgb_to_hex(color))
}       
function mydraw(){
  ctx.fillStyle = "#ffffff";
  ctx.fillRect(0,0,900,600);
    draw_title();
    width = 200;
    height = 600 - 35 - 10;
    x = 10;
    y = 35;
  ctx.fillStyle = rgb_to_hex([R,G,B]);
  ctx.fillRect(x,y,width,height);
    //canvas.draw_polygon([(x,y),(x+width,y),(x+width,y+height),(x,y+height)],1,rgb_to_hex((R,G,B)),rgb_to_hex((R,G,B)))
    //canvas.draw_text("Matching:",[200,20], 15, "Black")
    //canvas.draw_text("DMC",[310,20],15,"Black")
    //canvas.draw_text("Name",[370,20],15,"Black")
    switch (method){
    	case 1:
    		methodname = "Perceptive";
    	break;
    	case 2:
    		methodname = "Regular";
    	break;
    	case 3:
    		methodname = "Lab";
    	break;
    	case 4:
    		methodname = "Naive";
    	break;
    	case 5:
    		methodname = "Hue";
    	break;
    	case 6:
    		methodname = "Delta-E";
    	break;
    	default:
    }
    for (var i=0;i<28;i++){// in range(0,28):
        if (blend == 0){
            rectangle(200,35+i*20,DMC[i][3]);
            outTextSmall((i+1)+".",310,47+i*20);
            outText(DMC[i][0],340,47+i*20);
            outText(DMC[i][1],400,47+i*20);
            document.getElementById('status').innerHTML = "<b>Status:</b> No blend: 28 <b>out of " + DMC.length + " colors</b>. " + "Method: <b>" + methodname + "</b>.";
        } 
        if (blend > 0){
        	if (blendtype == 4){ //deal with strand info [ie. 1+3]
        		firstcolorstrand = BDMC[i][5];
        		secondcolorstrand = 4 - firstcolorstrand;
        		strandinfo = " " + firstcolorstrand + "+" + secondcolorstrand;
        	}else if (blendtype == 5){
        		firstcolorstrand = BDMC[i][5];
        		secondcolorstrand = 5 - firstcolorstrand;
        		strandinfo = " " + firstcolorstrand + "+" + secondcolorstrand;
        	}else if (blendtype == 6){
        		firstcolorstrand = BDMC[i][5];
        		secondcolorstrand = 6 - firstcolorstrand;
        		strandinfo = " " + firstcolorstrand + "+" + secondcolorstrand;	
        	}else{
        		strandinfo = "";
			}
            rectangle_blend_dots(200,35+i*20,BDMC[i],blend);
            outTextSmall((i+1)+".",310,47+i*20);
            outText(DMC[BDMC[i][1]][0]+","+DMC[BDMC[i][2]][0],340,47+i*20);
            outText(DMC[BDMC[i][1]][1]+","+DMC[BDMC[i][2]][1]+strandinfo,430,47+i*20);
            if (blendtype == 2){
              document.getElementById('status').innerHTML = "<b>Status:</b> Blend 50/50: 28 <b>out of " + BDMC.length + " colors</b> (1 strand of 1st color and 1 strand of 2nd color). " + "Method: <b>" + methodname + "</b>.";
            }else if (blendtype == 3){
              document.getElementById('status').innerHTML = "<b>Status:</b> Blend Third: 28 <b>out of " + BDMC.length + " colors</b>. (1 strand of 1st color and 2 strands of 2nd color). " + "Method: <b>" + methodname + "</b>.";
            }else if (blendtype == 4){
              document.getElementById('status').innerHTML = "<b>Status:</b> Blend 4th: 28 <b>out of " + BDMC.length + " colors</b>. (# of strands indicated at end of row [ie. 1+3 means 1 strand of 1st color and 3 strands of 2nd color]). " + "Method: <b>" + methodname + "</b>.";	
            }else if (blendtype == 5){
              document.getElementById('status').innerHTML = "<b>Status:</b> Blend 5th: 28 <b>out of " + BDMC.length + " colors</b>. (# of strands indicated at end of row [ie. 1+4 means 1 strand of 1st color and 4 strands of 2nd color]). " + "Method: <b>" + methodname + "</b>.";	
            }else if (blendtype == 6){
              document.getElementById('status').innerHTML = "<b>Status:</b> Blend 6th: 28 <b>out of " + BDMC.length + " colors</b>. (# of strands indicated at end of row [ie. 1+5 means 1 strand of 1st color and 5 strands of 2nd color]). " + "Method: <b>" + methodname + "</b>.";	
            }

        }
    }
}    
function sortFourFunction(a, b) {
    if (a[4] === b[4]) {
        return 0;
    }
    else {
        return (a[4] < b[4]) ? -1 : 1;
    }
}
function sort_closest_color_perceptive(){
  if (blend == 0) {
    DMC = jQuery.extend(true, {}, DMCstandard);
  }
  var array = $.map(DMC, function(value, index) {return [value];});
  DMC = array;
  
  method = 1;
  readinputs();
  for (var i = 0;i<DMC.length;i++){
    diff = Math.pow(((R-DMC[i][3][0])*0.3),2) + Math.pow(((G-DMC[i][3][1])*0.59),2) + Math.pow(((B-DMC[i][3][2])*0.11),2);
    DMC[i][4] = diff;
  }
  
  DMC.sort(sortFourFunction);
}
function find_closest_color_perceptive(){
    blend = 0;
    sort_closest_color_perceptive();
  mydraw();
}
function sort_closest_color_naive(){
  if (blend == 0) {
    DMC = jQuery.extend(true, {}, DMCstandard);
  }
  var array = $.map(DMC, function(value, index) {return [value];});
  DMC = array;
  
  method = 4;
  readinputs();
  for (var i = 0;i<DMC.length;i++){
    diff = Math.abs(((R-DMC[i][3][0]))) + Math.abs(((G-DMC[i][3][1]))) + Math.abs(((B-DMC[i][3][2])));
    DMC[i][4] = diff;
  }
  
  DMC.sort(sortFourFunction);
}
function find_closest_color_naive(){
    blend = 0;
    sort_closest_color_naive();
  mydraw();
}
function sort_closest_color(){
    if (blend == 0) {
    DMC = jQuery.extend(true, {}, DMCstandard);
  }
  var array = $.map(DMC, function(value, index) {return [value];});
  DMC = array;
  method = 2;
  readinputs();
  for (var i = 0;i<DMC.length;i++){
    diff =  Math.pow(((R-DMC[i][3][0])),2) + Math.pow(((G-DMC[i][3][1])),2) + Math.pow(((B-DMC[i][3][2])),2);
    DMC[i][4] = diff;
  }
    
  DMC.sort(sortFourFunction);   
}
function find_closest_color(){
    blend = 0;
    sort_closest_color();
  mydraw();
}
function RGB_to_XYZ(color){
    r = color[0] * 1.0;
    g = color[1] * 1.0;
    b = color[2] * 1.0;
    var_R = ( r / 255.0 );       
    var_G = ( g / 255.0 );     
    var_B = ( b / 255.0 );     

    if (var_R > 0.04045){
        var_R = ( ( var_R + 0.055 ) / 1.055 )** 2.4;
    }else{
        var_R = var_R / 12.92;
  }
    if ( var_G > 0.04045 ){
        var_G = ( ( var_G + 0.055 ) / 1.055 )** 2.4;
    }else{
        var_G = var_G / 12.92;
  }
    if ( var_B > 0.04045 ){
        var_B = ( ( var_B + 0.055 ) / 1.055 )** 2.4;
    }else{
        var_B = var_B / 12.92;
  }
    var_R = var_R * 100;
    var_G = var_G * 100;
    var_B = var_B * 100;

    //Observer. = 2°, Illuminant = D65
    X = var_R * 0.4124 + var_G * 0.3576 + var_B * 0.1805;
    Y = var_R * 0.2126 + var_G * 0.7152 + var_B * 0.0722;
    Z = var_R * 0.0193 + var_G * 0.1192 + var_B * 0.9505;
    return [X,Y,Z];
}
function XYZ_to_Lab(color){
    X = color[0];
    Y = color[1];
    Z = color[2];
    var_X = X / 95.047;     //     #ref_X =  95.047   Observer= 2°, Illuminant= D65
    var_Y = Y / 100.000;     //     #ref_Y = 100.000
    var_Z = Z / 108.883;     //     #ref_Z = 108.883

    if ( var_X > 0.008856 ){
        var_X = var_X ** ( 1.0/3 );
    }else{                 
        var_X = ( 7.787 * var_X ) + ( 16.0 / 116 );
  }
    if ( var_Y > 0.008856 ){
        var_Y = var_Y ** ( 1.0/3 );
    }else{      
        var_Y = ( 7.787 * var_Y ) + ( 16.0 / 116 );
  }
    if ( var_Z > 0.008856 ){
        var_Z = var_Z ** ( 1.0/3 );
    }else{  
        var_Z = ( 7.787 * var_Z ) + ( 16.0 / 116 );
  }

    L = ( 116 * var_Y ) - 16;
    a = 500 * ( var_X - var_Y );
    b = 200 * ( var_Y - var_Z );
    return [L,a,b];
}
function Lab_dif(color1, color2){
    c1 = XYZ_to_Lab(RGB_to_XYZ(color1));
    c2 = XYZ_to_Lab(RGB_to_XYZ(color2));
    dist = Math.pow((c2[0]-c1[0]),2) + (Math.pow(c2[1]-c1[1]),2) + Math.pow((c2[2]-c1[2]),2);
    return dist;
}               
function sort_closest_lab(){
    if (blend == 0) {
    DMC = jQuery.extend(true, {}, DMCstandard);
  }
  var array = $.map(DMC, function(value, index) {return [value];});
  DMC = array;
  method = 3;
  readinputs();
  for (var i = 0;i<DMC.length;i++){
     DMC[i][4] = Lab_dif([R,G,B],DMC[i][3]);
  }
    
  DMC.sort(sortFourFunction); 
}
function rgb_to_hsv(color) 
    { 
  
        // R, G, B values are divided by 255 
        // to change the range from 0..255 to 0..1 
        r = color[0] / 255.0; 
        g = color[1] / 255.0; 
        b = color[2] / 255.0; 
  
        // h, s, v = hue, saturation, value 
        cmax = Math.max(r, Math.max(g, b)); // maximum of r, g, b 
        cmin = Math.min(r, Math.min(g, b)); // minimum of r, g, b 
        diff = cmax - cmin; // diff of cmax and cmin. 
        h = -1, s = -1; 
          
        // if cmax and cmax are equal then h = 0 
        if (cmax == cmin) 
            h = 0; 
  
        // if cmax equal r then compute h 
        else if (cmax == r) 
            h = (60 * ((g - b) / diff) + 360) % 360; 
  
        // if cmax equal g then compute h 
        else if (cmax == g) 
            h = (60 * ((b - r) / diff) + 120) % 360; 
  
        // if cmax equal b then compute h 
        else if (cmax == b) 
            h = (60 * ((r - g) / diff) + 240) % 360; 
  
        // if cmax equal zero 
        if (cmax == 0) 
            s = 0; 
        else
            s = (diff / cmax) * 100; 
  
        // compute v 
        v = cmax * 100; 
        return [h,s,v];
    }
function hsv_diff(color1,color2){
	hsv1 = rgb_to_hsv(color1);
	hsv2 = rgb_to_hsv(color2);
	h_dif = Math.abs(hsv1[0] - hsv2[0]);
	if (h_dif > 180){
		h_dif = 180 - (h_dif-180);
	}
	h_dif /= 1.8;
	//h_dif = Math.round(h_dif/5)*5;
	s_dif = Math.abs(hsv2[1] - hsv1[1]);
	v_dif = Math.abs(hsv2[2] - hsv1[2]);
	

	// s_dif = Math.round(s_dif);
	// v_dif = Math.round(v_dif);
	return (Math.pow(h_dif,2) + Math.pow(s_dif,2) + Math.pow(v_dif,2));
}
function sort_closest_hue(){
    if (blend == 0) {
    DMC = jQuery.extend(true, {}, DMCstandard);
  }
  var array = $.map(DMC, function(value, index) {return [value];});
  DMC = array;
  method = 5;
  readinputs();
  for (var i = 0;i<DMC.length;i++){
  	 DMC[i][4] = hsv_diff([R,G,B],DMC[i][3]);
     //DMC[i][4] = Math.pow(Hue_dif([R,G,B],DMC[i][3])/180*255,2)+Math.pow(Average_diff([R,G,B],DMC[i][3]),2);
  }
    
  DMC.sort(sortFourFunction); 
}
function find_closest_hue(){
    blend = 0;
    sort_closest_hue();
  mydraw();
}
function color_Hue(color){ // Hue calculation
  var r = color[0]/255.0;
  var g = color[1]/255.0;
  var b = color[2]/255.0;
  var maxv = Math.max(r,g,b);
  var minv = Math.min(r,g,b);
  var Hue = 0;
  if ((r >= g) && (r >= b)){ //r is max
    Hue = (g-b)/(maxv-minv)
  }
  if ((g >= r) && (g >= b)){ //g is max
    Hue = 2.0 + (b-r)/(maxv-minv)
  }
  if ((b >= r) && (b >= g)){ //b is max
    Hue = 4.0 + (r-g)/(maxv-minv)
  }
  Hue = Hue * 60;
  if (Hue < 0){
    Hue += 360;
  }
  return Hue;
}
function Average_diff(color1,color2){
  sum1 = (color1[0] + color1[1] + color1[2])/3;
  sum2 = (color2[0] + color2[1] + color2[2])/3;
  dist = Math.abs(sum1-sum2);
  return dist;
}
function Hue_dif(color1, color2){
    h1 = color_Hue(color1);
    h2 = color_Hue(color2);
    dist = Math.abs(h1-h2);
  if (dist > 180){
    dist = 180-(dist-180);
  }
    return dist;
} 
function find_closest_lab(){
    blend = 0;
    sort_closest_lab();
  mydraw();
}
// the following functions are based off of the pseudocode
// found on www.easyrgb.com

function lab2rgb(lab){
  var y = (lab[0] + 16) / 116,
      x = lab[1] / 500 + y,
      z = y - lab[2] / 200,
      r, g, b;

  x = 0.95047 * ((x * x * x > 0.008856) ? x * x * x : (x - 16/116) / 7.787);
  y = 1.00000 * ((y * y * y > 0.008856) ? y * y * y : (y - 16/116) / 7.787);
  z = 1.08883 * ((z * z * z > 0.008856) ? z * z * z : (z - 16/116) / 7.787);

  r = x *  3.2406 + y * -1.5372 + z * -0.4986;
  g = x * -0.9689 + y *  1.8758 + z *  0.0415;
  b = x *  0.0557 + y * -0.2040 + z *  1.0570;

  r = (r > 0.0031308) ? (1.055 * Math.pow(r, 1/2.4) - 0.055) : 12.92 * r;
  g = (g > 0.0031308) ? (1.055 * Math.pow(g, 1/2.4) - 0.055) : 12.92 * g;
  b = (b > 0.0031308) ? (1.055 * Math.pow(b, 1/2.4) - 0.055) : 12.92 * b;

  return [Math.max(0, Math.min(1, r)) * 255, 
          Math.max(0, Math.min(1, g)) * 255, 
          Math.max(0, Math.min(1, b)) * 255]
}


function rgb2lab(rgb){
  var r = rgb[0] / 255,
      g = rgb[1] / 255,
      b = rgb[2] / 255,
      x, y, z;

  r = (r > 0.04045) ? Math.pow((r + 0.055) / 1.055, 2.4) : r / 12.92;
  g = (g > 0.04045) ? Math.pow((g + 0.055) / 1.055, 2.4) : g / 12.92;
  b = (b > 0.04045) ? Math.pow((b + 0.055) / 1.055, 2.4) : b / 12.92;

  x = (r * 0.4124 + g * 0.3576 + b * 0.1805) / 0.95047;
  y = (r * 0.2126 + g * 0.7152 + b * 0.0722) / 1.00000;
  z = (r * 0.0193 + g * 0.1192 + b * 0.9505) / 1.08883;

  x = (x > 0.008856) ? Math.pow(x, 1/3) : (7.787 * x) + 16/116;
  y = (y > 0.008856) ? Math.pow(y, 1/3) : (7.787 * y) + 16/116;
  z = (z > 0.008856) ? Math.pow(z, 1/3) : (7.787 * z) + 16/116;

  return [(116 * y) - 16, 500 * (x - y), 200 * (y - z)]
}
// this code found at https://github.com/antimatter15/rgb-lab/blob/master/color.js
// calculate the perceptual distance between colors in CIELAB
// https://github.com/THEjoezack/ColorMine/blob/master/ColorMine/ColorSpaces/Comparisons/Cie94Comparison.cs

function deltaE(labA, labB){
  var deltaL = labA[0] - labB[0];
  var deltaA = labA[1] - labB[1];
  var deltaB = labA[2] - labB[2];
  var c1 = Math.sqrt(labA[1] * labA[1] + labA[2] * labA[2]);
  var c2 = Math.sqrt(labB[1] * labB[1] + labB[2] * labB[2]);
  var deltaC = c1 - c2;
  var deltaH = deltaA * deltaA + deltaB * deltaB - deltaC * deltaC;
  deltaH = deltaH < 0 ? 0 : Math.sqrt(deltaH);
  var sc = 1.0 + 0.045 * c1;
  var sh = 1.0 + 0.015 * c1;
  var deltaLKlsl = deltaL / (1.0);
  var deltaCkcsc = deltaC / (sc);
  var deltaHkhsh = deltaH / (sh);
  var i = deltaLKlsl * deltaLKlsl + deltaCkcsc * deltaCkcsc + deltaHkhsh * deltaHkhsh;
  return i < 0 ? 0 : Math.sqrt(i);
}
function sort_closest_deltaE(){
    if (blend == 0) {
    DMC = jQuery.extend(true, {}, DMCstandard);
  }
  var array = $.map(DMC, function(value, index) {return [value];});
  DMC = array;
  method = 6;
  readinputs();
  for (var i = 0;i<DMC.length;i++){
     DMC[i][4] = deltaE(rgb2lab([R,G,B]),rgb2lab(DMC[i][3]));
  }
    
  DMC.sort(sortFourFunction); 
}
function find_closest_deltaE(){
    blend = 0;
    sort_closest_deltaE();
  mydraw();
}
BDMC = [];

blend_range = 50;
function blend50s(){
  blend50colors = [];
  for (var j=0;j<DMC.length;j++){ //j in range(0,len(DMC)-1):
        for (var k=j;k<DMC.length;k++){//k in range(j,len(DMC)):
            r = Math.abs(DMC[j][3][0]-DMC[k][3][0]);
            g = Math.abs(DMC[j][3][1]-DMC[k][3][1]);
            b = Math.abs(DMC[j][3][2]-DMC[k][3][2]);
            if (r <= blend_range && g <= blend_range && b <= blend_range){
              newblend = ["Blend",j,k,[
                                       Math.round((DMC[j][3][0]+DMC[k][3][0])/2.0),
                                       Math.round((DMC[j][3][1]+DMC[k][3][1])/2.0),
                                       Math.round((DMC[j][3][2]+DMC[k][3][2])/2.0)],0]
              //BDMC[BDMC.length] = newblend;
              blend50colors.push(newblend);
            }
    }
  }
  return blend50colors;
}
function blend3s(){
  blend3colors = [];
  for (var j=0;j<DMC.length;j++){ //j in range(0,len(DMC)-1):
        for (var k=j;k<DMC.length;k++){//k in range(j,len(DMC)):
            r = Math.abs(DMC[j][3][0]-DMC[k][3][0]);
            g = Math.abs(DMC[j][3][1]-DMC[k][3][1]);
            b = Math.abs(DMC[j][3][2]-DMC[k][3][2]);
            if (r <= blend_range && g <= blend_range && b <= blend_range){
              newblend = ["Blend",j,k,[
                                       Math.round((DMC[j][3][0]+DMC[k][3][0]*2)/3.0),
                                       Math.round((DMC[j][3][1]+DMC[k][3][1]*2)/3.0),
                                       Math.round((DMC[j][3][2]+DMC[k][3][2]*2)/3.0)],0]
              //BDMC[BDMC.length] = newblend;
              blend3colors.push(newblend);
              if (j!=k){
                newblend = ["Blend",k,j,[
                                         Math.round((DMC[j][3][0]*2+DMC[k][3][0])/3.0),
                                         Math.round((DMC[j][3][1]*2+DMC[k][3][1])/3.0),
                                         Math.round((DMC[j][3][2]*2+DMC[k][3][2])/3.0)],0]
                //BDMC[BDMC.length] = newblend;
                blend3colors.push(newblend);
              }
            }
    }
  }
  return blend3colors;
}
function blend4s(){
  blend4colors = [];
  for (var j=0;j<DMC.length;j++){ //j in range(0,len(DMC)-1):
        for (var k=j;k<DMC.length;k++){//k in range(j,len(DMC)):
            r = Math.abs(DMC[j][3][0]-DMC[k][3][0]);
            g = Math.abs(DMC[j][3][1]-DMC[k][3][1]);
            b = Math.abs(DMC[j][3][2]-DMC[k][3][2]);
            if (r <= blend_range && g <= blend_range && b <= blend_range){
              // 1+3 combo
              newblend = ["Blend",j,k,[
                                       Math.round((DMC[j][3][0]+DMC[k][3][0]*3)/4.0),
                                       Math.round((DMC[j][3][1]+DMC[k][3][1]*3)/4.0),
                                       Math.round((DMC[j][3][2]+DMC[k][3][2]*3)/4.0)],0,1] 
                                       //last index indicates how many strands of 1st color (1)
              blend4colors.push(newblend);
              if (j!=k){ //if colors are different then we add other combinations
              	//k,j instead of j,k so that we get the 3+1
                newblend = ["Blend",k,j,[
                                       Math.round((DMC[j][3][0]*3+DMC[k][3][0])/4.0),
                                       Math.round((DMC[j][3][1]*3+DMC[k][3][1])/4.0),
                                       Math.round((DMC[j][3][2]*3+DMC[k][3][2])/4.0)],0,1]
                                       //last index indicates how many strands of 1st color (1)
                blend4colors.push(newblend);
                // 2+2 combo
                newblend = ["Blend",j,k,[
                                       Math.round((DMC[j][3][0]*2+DMC[k][3][0]*2)/4.0),
                                       Math.round((DMC[j][3][1]*2+DMC[k][3][1]*2)/4.0),
                                       Math.round((DMC[j][3][2]*2+DMC[k][3][2]*2)/4.0)],0,2]
                                       //last index indicates how many strands of 1st color (2)
                blend4colors.push(newblend);
              }
            }
    }
  }
  return blend4colors;
}
function blend5s(){
  blend5colors = [];
  for (var j=0;j<DMC.length;j++){ //j in range(0,len(DMC)-1):
        for (var k=j;k<DMC.length;k++){//k in range(j,len(DMC)):
            r = Math.abs(DMC[j][3][0]-DMC[k][3][0]);
            g = Math.abs(DMC[j][3][1]-DMC[k][3][1]);
            b = Math.abs(DMC[j][3][2]-DMC[k][3][2]);
            if (r <= blend_range && g <= blend_range && b <= blend_range){
              // 1+4 combo
              newblend = ["Blend",j,k,[
                                       Math.round((DMC[j][3][0]+DMC[k][3][0]*4)/5.0),
                                       Math.round((DMC[j][3][1]+DMC[k][3][1]*4)/5.0),
                                       Math.round((DMC[j][3][2]+DMC[k][3][2]*4)/5.0)],0,1] 
                                       //last index indicates how many strands of 1st color (1)
              blend5colors.push(newblend);
              if (j!=k){ //if colors are different then we add other combinations
              	// 1+4 combo
	              newblend = ["Blend",k,j,[
	                                       Math.round((DMC[j][3][0]*4+DMC[k][3][0])/5.0),
	                                       Math.round((DMC[j][3][1]*4+DMC[k][3][1])/5.0),
	                                       Math.round((DMC[j][3][2]*4+DMC[k][3][2])/5.0)],0,1] 
	                                       //last index indicates how many strands of 1st color (1)
	              blend5colors.push(newblend);
	              // 2+3 combo
  		          newblend = ["Blend",j,k,[
	                                       Math.round((DMC[j][3][0]*2+DMC[k][3][0]*3)/5.0),
	                                       Math.round((DMC[j][3][1]*2+DMC[k][3][1]*3)/5.0),
	                                       Math.round((DMC[j][3][2]*2+DMC[k][3][2]*3)/5.0)],0,2] 
	                                       //last index indicates how many strands of 1st color (1)
	              blend5colors.push(newblend);
	              // 2+3 combo
  		          newblend = ["Blend",k,j,[
	                                       Math.round((DMC[j][3][0]*3+DMC[k][3][0]*2)/5.0),
	                                       Math.round((DMC[j][3][1]*3+DMC[k][3][1]*2)/5.0),
	                                       Math.round((DMC[j][3][2]*3+DMC[k][3][2]*2)/5.0)],0,2] 
	                                       //last index indicates how many strands of 1st color (1)
	              blend5colors.push(newblend);
              }
            }
    }
  }
  return blend5colors;
}
function find_blend5(b){
  document.body.style.cursor = 'wait';//document.body.style.cursor = 'progress';
    blendtype = 5;
    blend = b;
    BDMC = blend5s();
    
  //endprogress();
    //saveDMC = jQuery.extend(true, {}, DMC); // saveDMC = DMC
    saveDMC = DMC.slice();
    //DMC = jQuery.extend(true, {}, BDMC); //DMC = BDMC
    DMC = BDMC.slice();
    if (method == 1){
        sort_closest_color_perceptive();
    }else if (method ==2){
        sort_closest_color();
    }else if (method ==3) {
        sort_closest_lab();
  }else if (method == 4){
    sort_closest_color_naive();
  }else if (method == 5){
    sort_closest_hue();
  }else if (method == 6){
    sort_closest_deltaE();
  }
    //BDMC = jQuery.extend(true, {}, DMC); //BDMC = DMC
    //DMC = jQuery.extend(true, {}, saveDMC); //DMC = saveDMC
    BDMC = DMC.slice();
    DMC = saveDMC.slice();
  
  mydraw();

document.body.style.cursor = 'default';
}
function blend6s(){
  blend6colors = [];
  for (var j=0;j<DMC.length;j++){ //j in range(0,len(DMC)-1):
        for (var k=j;k<DMC.length;k++){//k in range(j,len(DMC)):
            r = Math.abs(DMC[j][3][0]-DMC[k][3][0]);
            g = Math.abs(DMC[j][3][1]-DMC[k][3][1]);
            b = Math.abs(DMC[j][3][2]-DMC[k][3][2]);
            if (r <= blend_range && g <= blend_range && b <= blend_range){
              // 1+5 combo
              newblend = ["Blend",j,k,[
                                       Math.round((DMC[j][3][0]+DMC[k][3][0]*5)/6.0),
                                       Math.round((DMC[j][3][1]+DMC[k][3][1]*5)/6.0),
                                       Math.round((DMC[j][3][2]+DMC[k][3][2]*5)/6.0)],0,1] 
                                       //last index indicates how many strands of 1st color (1)
              blend6colors.push(newblend);
              if (j!=k){ //if colors are different then we add other combinations
              	// 1+5 combo kj
	              newblend = ["Blend",k,j,[
	                                       Math.round((DMC[j][3][0]*5+DMC[k][3][0])/6.0),
	                                       Math.round((DMC[j][3][1]*5+DMC[k][3][1])/6.0),
	                                       Math.round((DMC[j][3][2]*5+DMC[k][3][2])/6.0)],0,1] 
	                                       //last index indicates how many strands of 1st color (1)
	              blend6colors.push(newblend);
	            // 2+4 
	              newblend = ["Blend",j,k,[
	                                       Math.round((DMC[j][3][0]*2+DMC[k][3][0]*4)/6.0),
	                                       Math.round((DMC[j][3][1]*2+DMC[k][3][1]*4)/6.0),
	                                       Math.round((DMC[j][3][2]*2+DMC[k][3][2]*4)/6.0)],0,2] 
	                                       //last index indicates how many strands of 1st color (1)
	              blend6colors.push(newblend);  
	            // 2+4 combo kj
	              newblend = ["Blend",k,j,[
	                                       Math.round((DMC[j][3][0]*4+DMC[k][3][0]*2)/6.0),
	                                       Math.round((DMC[j][3][1]*4+DMC[k][3][1]*2)/6.0),
	                                       Math.round((DMC[j][3][2]*4+DMC[k][3][2]*2)/6.0)],0,2] 
	                                       //last index indicates how many strands of 1st color (1)
	              blend6colors.push(newblend);    
	            // 3+3 
	              newblend = ["Blend",j,k,[
	                                       Math.round((DMC[j][3][0]*3+DMC[k][3][0]*3)/6.0),
	                                       Math.round((DMC[j][3][1]*3+DMC[k][3][1]*3)/6.0),
	                                       Math.round((DMC[j][3][2]*3+DMC[k][3][2]*3)/6.0)],0,3] 
	                                       //last index indicates how many strands of 1st color (1)
	              blend6colors.push(newblend);      
	          }
            }
    }
  }
  return blend6colors;
}
function find_blend6(b){
  document.body.style.cursor = 'wait';//document.body.style.cursor = 'progress';
    blendtype = 6;
    blend = b;
    BDMC = blend6s();
    
  //endprogress();
    //saveDMC = jQuery.extend(true, {}, DMC); // saveDMC = DMC
    saveDMC = DMC.slice();
    //DMC = jQuery.extend(true, {}, BDMC); //DMC = BDMC
    DMC = BDMC.slice();
    if (method == 1){
        sort_closest_color_perceptive();
    }else if (method ==2){
        sort_closest_color();
    }else if (method ==3) {
        sort_closest_lab();
  }else if (method == 4){
    sort_closest_color_naive();
  }else if (method == 5){
    sort_closest_hue();
  }else if (method == 6){
    sort_closest_deltaE();
  }
    //BDMC = jQuery.extend(true, {}, DMC); //BDMC = DMC
    //DMC = jQuery.extend(true, {}, saveDMC); //DMC = saveDMC
    BDMC = DMC.slice();
    DMC = saveDMC.slice();
  
  mydraw();

document.body.style.cursor = 'default';
}
function find_blend4(b){
  document.body.style.cursor = 'wait';//document.body.style.cursor = 'progress';
    blendtype = 4;
    blend = b;
    BDMC = blend4s();
    
  //endprogress();
    //saveDMC = jQuery.extend(true, {}, DMC); // saveDMC = DMC
    saveDMC = DMC.slice();
    //DMC = jQuery.extend(true, {}, BDMC); //DMC = BDMC
    DMC = BDMC.slice();
    if (method == 1){
        sort_closest_color_perceptive();
    }else if (method ==2){
        sort_closest_color();
    }else if (method ==3) {
        sort_closest_lab();
  }else if (method == 4){
    sort_closest_color_naive();
  }else if (method == 5){
    sort_closest_hue();
  }else if (method == 6){
    sort_closest_deltaE();
  }
    //BDMC = jQuery.extend(true, {}, DMC); //BDMC = DMC
    //DMC = jQuery.extend(true, {}, saveDMC); //DMC = saveDMC
    BDMC = DMC.slice();
    DMC = saveDMC.slice();
  
  mydraw();

document.body.style.cursor = 'default';
}
function find_blend3(b){
  document.body.style.cursor = 'wait';//document.body.style.cursor = 'progress';
    blendtype = 3;
    blend = b;
    BDMC = blend3s();
    
  //endprogress();
    //saveDMC = jQuery.extend(true, {}, DMC); // saveDMC = DMC
    saveDMC = DMC.slice();
    //DMC = jQuery.extend(true, {}, BDMC); //DMC = BDMC
    DMC = BDMC.slice();
    if (method == 1){
        sort_closest_color_perceptive();
    }else if (method ==2){
        sort_closest_color();
    }else if (method ==3) {
        sort_closest_lab();
  }else if (method == 4){
    sort_closest_color_naive();
  }else if (method == 5){
    sort_closest_hue();
  }else if (method == 6){
    sort_closest_deltaE();
  }
    //BDMC = jQuery.extend(true, {}, DMC); //BDMC = DMC
    //DMC = jQuery.extend(true, {}, saveDMC); //DMC = saveDMC
    BDMC = DMC.slice();
    DMC = saveDMC.slice();
  
  mydraw();

document.body.style.cursor = 'default';
}
function find_blend50(b){
  document.body.style.cursor = 'wait';//document.body.style.cursor = 'progress';
    blendtype = 2;
    blend = b;
    BDMC = blend50s();
    
  //endprogress();
    //saveDMC = jQuery.extend(true, {}, DMC); // saveDMC = DMC
    saveDMC = DMC.slice();
    //DMC = jQuery.extend(true, {}, BDMC); //DMC = BDMC
    DMC = BDMC.slice();
    if (method == 1){
        sort_closest_color_perceptive();
    }else if (method ==2){
        sort_closest_color();
    }else if (method ==3) {
        sort_closest_lab();
  }else if (method == 4){
    sort_closest_color_naive();
  }else if (method == 5){
    sort_closest_hue();
  }else if (method == 6){
    sort_closest_deltaE();
  }
    //BDMC = jQuery.extend(true, {}, DMC); //BDMC = DMC
    //DMC = jQuery.extend(true, {}, saveDMC); //DMC = saveDMC
    BDMC = DMC.slice();
    DMC = saveDMC.slice();
  
  mydraw();

document.body.style.cursor = 'default';
}
changeRGB();
//========================================= support zoom feature
function findPos(obj) {
    var curleft = 0, curtop = 0;
    if (obj.offsetParent) {
        do {
            curleft += obj.offsetLeft;
            curtop += obj.offsetTop;
        } while (obj = obj.offsetParent);
        return { x: curleft, y: curtop };
    }
    return undefined;
}
zoomctx = document.getElementById('zoomcanvas').getContext('2d');
zoomfact = 4;
lockzoom = 0;
function zoom(x,y,c){
	if (lockzoom == 0){ //if not lock zoom then redraw it otherwise don't draw anything
		zoomctx.fillStyle = "#ffffff";
	    zoomctx.fillRect(0,0,zoomfact*40,zoomfact*40);
	    for (var iy=0;iy<40;iy++){
	    	for (var ix=0;ix<40;ix++){
	    		px = (x-20)+ix;     
	    		py = (y-20)+iy;
	    		var p = c.getImageData(px, py, 1, 1).data;
				zoomctx.fillStyle = rgb_to_hex(p);
	    		zoomctx.fillRect(ix*zoomfact,iy*zoomfact,zoomfact,zoomfact);		
	    	}
	    }
	}
}
$('#myCanvas').mouseup(function(e) {
	if (lockzoom == 0){
		lockzoom = 1;
	}else {
		lockzoom = 0;
	}
});	
$('#myCanvas').mousemove(function(e) {
    var pos = findPos(this);
    var x = e.pageX - pos.x;
    var y = e.pageY - pos.y;
    //var coord = "x=" + x + ", y=" + y;
    var c = this.getContext('2d');
    //var p = c.getImageData(x, y, 1, 1).data;
    zoom(x,y,c);
    //var hex = "#" + ("000000" + rgbToHex(p[0], p[1], p[2])).slice(-6);
    //$('#status2').html(coord + "<br>" + hex + " &nbsp;&nbsp;R:" + p[0] + " G:" + p[1] + " B:" + p[2]);
	//$('#color2').css('background', hex)
});
